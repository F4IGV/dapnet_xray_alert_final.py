# Solar X-Ray Alert to DAPNET  
By F4IGV and ChatGPT  
ASCII only - POCSAG compatible

This Python script monitors the real-time X-Ray flux from the HamQSL XML feed and sends automatic POCSAG alerts through DAPNET when a solar storm begins (threshold exceeded) and when it ends (with total duration included).

It is ideal for amateur radio operators who want to be notified of solar activity spikes directly on their DAPNET pagers.

---

## Features

- Retrieves X-Ray flux values from HamQSL XML  
- Detects when flux exceeds a configurable threshold (default: M5.0)  
- Sends **start alert** (solar storm begins)  
- Sends **end alert** including storm duration  
- Duration tracking stored in local text file  
- Supports multiple DAPNET callsigns  
- Emergency flag supported  
- Fully ASCII messages (POCSAG safe)  
- Lightweight and independent script  

---

## Example alerts

### Start of solar storm
```text
ALERTE XRAY : M5.2 (seuil M5.0)  DEBUT ORAGE SOLAIRE
```

### End of solar storm
```text
FIN ORAGE SOLAIRE  XRAY : C8.9  Duree : 1h 22min
```

---

## Installation

### 1. Clone the repository
```bash
git clone https://github.com/your_username/your_repository.git
cd your_repository
```

### 2. Install Python 3
Python 3.8 or newer recommended.

Check version:
```bash
python --version
```

### 3. Install dependencies
```bash
pip install requests python-dateutil
```

---

## Configuration

Edit the script and set your DAPNET credentials:

```python
DAPNET_USER = "f4abc"
DAPNET_PASS = "123456"
DAPNET_CALLSIGN = ["f4abc", "f4def"]
DAPNET_TRANSMITTER_GROUP = "f-53"
```

Set the X-Ray alert threshold:

```python
XRAY_THRESHOLD = "M1.0"
```

HamQSL XML feed URL:

```python
HAMQSL_XML_URL = "https://www.hamqsl.com/solarxml.php"
```

---

## Manual execution

```bash
python xray_alert.py
```

Example output:
```text
Recuperation flux X-Ray…
Flux X-Ray detecte : M6.3
[ALERTE] Orage solaire detecte !
[OK] Message envoye : ALERTE XRAY : M6.3...
```

During storm end:
```text
Flux X-Ray detecte : C9.1
[INFO] Fin d'orage solaire detectee.
[OK] Message envoye : FIN ORAGE SOLAIRE XRAY : C9.1 Duree : 22min
```

---

## How it works

1. Fetches X-Ray flux from HamQSL  
2. Converts class (A/B/C/M/X) to numeric W/m^2 value  
3. Compares with threshold  
4. When threshold is crossed upward:  
   - Save UTC timestamp  
   - Send emergency start alert  
   - Set state to "alert"  
5. When flux falls below threshold:  
   - Compute duration  
   - Send end alert  
   - Reset state to "ok"  

Two internal text files are used:

```
xray_alert_state.txt   # keeps current state: "ok" or "alert"
xray_alert_start.txt   # timestamp of storm start in UTC
```

---

## Project structure

```
xray_alert.py              # Main script
xray_alert_state.txt       # Autogenerated (storm state)
xray_alert_start.txt       # Autogenerated (start timestamp)
README.md                  # Documentation
```

---

## Requirements

Install dependencies:
```bash
pip install requests python-dateutil
```

---

## Troubleshooting

- X-Ray value not detected  
  - HamQSL XML might be down  
  - Check your internet connection  

- Alerts not sent  
  - Verify DAPNET credentials  
  - Ensure callsigns are valid  
  - Confirm correct transmitter group  

- Duration incorrect  
  - Delete both state files and restart script  

---

## License

This script is provided for amateur radio experimentation only.  
Use responsibly.

---

## Credits

Developed by **F4IGV** with assistance from **ChatGPT**.  
Thanks to the amateur radio community for feedback and ideas.



exemple de log généré:

<img width="1187" height="618" alt="screen_log_orage_solair" src="https://github.com/user-attachments/assets/6145674f-fb7d-43d4-b057-12181bfd4b6e" />
